
# 计算声学
2023.3.20
[toc]

## 第一部分·物理基础

### Reynolds输运定理
$$d [ \iiint_{V(t)}[B ( \vec x , t ) d v ] / d t = \iiint_{V(t)} \frac{\partial B}{\partial t} dv + \iint_{\partial V(t)} B \vec{u} dS$$ 

$$ d [ \iiint_{V(t)}[B ( \vec x , t ) d v ] / d t = \iiint _ { V ( t ) }  \frac {\partial B}{\partial t}+ \nabla \cdot ( B \vec u ) dv $$

Reynolds输运定理实际上就是三维Leibniz积分法则在流体力学中的应用,右端第一项是本地变化率,第二项是边界上的输入变化率

### 质量守恒

将流场中的物理量$B$换成密度$\rho$,任意一个流体微元在运动的过程中,其质量都不会发生改变,对于任意体积V都满足$d [ \int \int \int_{V(t)}[B ( \vec x , t ) d v ] / d t = 0$.可得:
$$\frac{\partial \rho}{\partial t}+\nabla \cdot (\rho \vec u)=0$$

$$\frac{d \rho}{dt}+\rho \nabla \cdot \vec u =0 $$

### 动量守恒
体积$V(t)$中的流体，其动量单位时间的变化应当等于外界动量的输入，而外力包含体积力$\vec f$（单位体积收到的力）和应力两部分。

$$ \frac{d}{dt} \iiint_{V(t)} \rho \vec u dv = \iiint _{V(t)}  \vec f(\vec x,t)dv+\iint_{\partial V(t)} \sigma d \vec S $$

由高斯定理可得：

$$\iint_{\partial V(t)} \sigma d S =  \iiint_{V(t)} \nabla \cdot \sigma dv $$

由Reynolds输运定理可得：

$$\frac{d}{dt} \iiint_{V(t)} \rho \vec u dv = \iiint_{V(t)} \vec f + \nabla\cdot \sigma dv$$

即
$$\rho [\frac{\partial \vec u}{\partial t} + (\vec u \cdot \nabla)\vec u ]= \nabla \cdot \sigma + \vec f $$

$\frac{d \vec u}{dt} = \frac{\partial \vec u}{\partial t}+(\vec u \cdot \nabla)\vec u$ 可得另一种Cauchy方程：
$$\rho\frac{d \vec u}{d t} = \nabla \cdot \sigma + \vec f$$

速度散度的物理意义实际上就是体积变化率，对于不可压缩流体或固体，其体积变化率为0，所以$\nabla \cdot \vec u=0$，所以固体Cauchy方程
$$\rho \frac{\partial \vec u}{\partial t} = \nabla\cdot \sigma + \vec f$$

### 能量守恒

$$\frac{d(E_k+Ei)}{dt}=P_w-Q$$
其中Q定义为流出的热量，带入各量的表达式可得
$$\frac{d[\iiint_V(t) (\rho u_i u_i/2+\rho e)dv]}{dt}=\iint_{\partial V(t) }T_i u_i ds+\iiint_{V(t)} f_i u_i dv - \iint_{\partial V(t)} q_i n_i ds $$
$$\frac{d[\iiint_V(t) (\rho u_i u_i/2+\rho e)dv]}{dt}=\iiint_{V(t)}[(T_{ij}u_i)_{,j}+ f_i u_i -q_{i,i}]dv $$
$$\frac{\iiint_V(t)\rho d(u_i u_i/2+e)/dt}{dv}=\iiint_{V(t)}[(T_{ij}u_i)_{,j}+ f_i u_i -q_{i,i}]dv $$
移项并去除积分号
$$\rho d(u_i u_i/2+e)/dt-\iiint_{V(t)}[(T_{ij}u_i)_{,j}- f_i u_i +q_{i,i}]=0$$
$$(\rho \frac{du_i}{dt}-T_{ij,j}-f_i)u_i+\rho \dot e -T_{ij}u_{i,j}+q_{i,j=0}$$
已知$\rho \frac{du_i}{dt}-T_{ij,j}-f_i=0$,即得
$$\rho \dot e -T_{ij}u_{i,j}+q_{i,j=0}$$



### 应力应变

当小体元发生形变是收到周围相邻部分力地作用，小体院单位表面上的力称为应力，固体中能产生法向应力和切应力，表面一般收到9个应力分量$T_{ij}$，$i=j$时代表法向应力，$i \neq j$时代表切应力,且具有对称性

$$T_{ij}=T_{ji}$$

确定应力特性需要6个分量

柯西应变可以分为主应变（normal strain）与剪切应变（角应变，shear strain）两种。一维定义$e=\lim_{L\to0}\frac{\Delta L}{L}$，在三维中用柯西应变张量可方便地表示




### 虎克定律
$\boldsymbol{\sigma}=Ee$，其中 ${\boldsymbol{\sigma}}=F\:/\:A,$

广义虎克定律可以描述应力与应变的本构关系，一般情况下，应力与应变具有线性关系，每个分量均对应变有贡献，即每个应力均是6个应变分量的线性函数。

$$\begin{bmatrix}T_{11}\\ T_{22}\\ T_{33}\\ T_{32}\\ T_{13}\\ T_{13}\\ T_{21}\end{bmatrix} = \begin{bmatrix}C_{11}&C_{12}&C_{13}&C_{14}&C_{15}&C_{16}\\ C_{21}&C_{22}&C_{23}&C_{24}&C_{25}&C_{26}\\ C_{31}&C_{32}&C_{33}&C_{34}&C_{35}&C_{36}\\ C_{41}&C_{42}&C_{43}&C_{44}&C_{45}&C_{46}\\ C_{51}&C_{52}&C_{53}&C_{54}&C_{55}&C_{56}\\ C_{61}&C_{62}&C_{63}&C_{64}&C_{65}&C_{66} \end{bmatrix} \begin{bmatrix}\varepsilon_{11}\\ \varepsilon_{22}\\ \varepsilon_{33}\\ \varepsilon_{32}\\ \varepsilon_{13}\\ \varepsilon_{21}\end{bmatrix}$$

其中$C_{ij}$为弹性系数，固体具有$36$个弹性系数，具有对称性$C_{ij}=C_{ji}$，可减少到$21$个，各向同性固体可减少到$2$个

$$\begin{bmatrix}T_{11}\\ T_{22}\\ T_{33}\\ T_{32}\\ T_{13}\\ T_{13}\\ T_{21}\end{bmatrix}=\begin{bmatrix}{{c_{11}}}&{{c_{11}-2c_{44}}}&{{c_{11}-2c_{44}}}&{{0}}&{{0}}&{{0}}\\ {{c_{11}-2c_{44}}}&{{c_{11}}}&{{c_{11}-2c_{44}}}&{{0}}&{{0}}&{{0}}\\ {{c_{11}-2c_{44}}}&{{c_{11}-2c_{44}}}&{{c_{11}}}&{{0}}&{{0}}&{{0}}\\ {{0}}&{{0}}&{{0}}&{{c_{44}}}&{{0}}&{{0}}\\ {{0}}&{{0}}&{{0}}&{{0}}&{{c_{44}}}&{{0}}\\ {{0}}&{{0}}&{{0}}&{{0}}&{{0}}&{{c_{44}}}\end{bmatrix} \begin{bmatrix}\varepsilon_{11}\\ \varepsilon_{22}\\ \varepsilon_{33}\\ 2\varepsilon_{32}\\ 2\varepsilon_{13}\\ 2\varepsilon_{21}\end{bmatrix}$$

其中
$$c_{44}=c_{55}=c_{66},c_{11}=c_{22}=c_{33}$$
$$c_{ij}=c_{11}-2c_{44},(i \neq j)$$
    

### 波动方程
$$\rho(\partial u_{_i}\:/\:\partial t)-\vec{f}_{_i}+P_{_i}=0$$
忽略体力
$$\rho(\partial\vec{u}\:/\:\partial t)+\nabla P=0$$
因 $\vec{u}=\frac{\partial \vec{d}}{\partial t}$，方程两端同时取$\nabla$得

$$\rho\partial^{2}(\nabla\cdot\vec{d}\:)\:/\:\partial^{2}t+\nabla\cdot\nabla P=0$$
$$\rho\partial^{2}(\theta \:)\:/\:\partial^{2}t+\nabla\cdot\nabla P=0$$
其中$\theta$是体积张量

流体中波动方程
$$\partial^2P\:/\:\partial^2t=c^2\nabla^2P$$

其中声速 $c=\sqrt{\frac{k}{\rho}}$，体积模量 $k=-\frac{P}{\theta}$

固体中直接用表面力表示
$$\rho\partial v_{i}\:/\:\partial t\:-\:f_{i}(\vec{x},t)\:-\:T_{i j,j}=0$$
其中$\dot{T}_{ij}=C_{ijkl}\:\nu_{k,l}$


### 分析力学

广义坐标

#### 约束
对非自由体的某些位移起限制作用的条件称为约束

通常只能知道约束力的作用，但无法知道详细的约束力，通过约束力关联的变量之间不独立。为了解决这个问题，我们引入广义坐标。

完整约束的广义坐标等于其自由度数目，非完整约系统的有些速度项无法消去，所以其广义坐标数一般大于系统的自由度的数目
> $\dot q$ 和 ${q}$ 是不同的两个变量

#### 广义速度
对广义坐标求全导数，下式中$q_{j}$用了求和约定
$$\dot{r}_i=dr_i\:/\ dt=\partial r_i\:/\partial t+(\partial r_i\:/\partial q_j)\dot{q}_j$$
可以写成矩阵形式，A可以称为 **雅可比矩阵**(Jacobian matrix),是一阶偏导数以一定方式排列成的矩阵，其行列式称为雅可比行列式
$$\dot{\mathbf r}=A\dot{\mathbf q}+\mathbf B$$

$$\mathbf{B}={\left(\begin{array}{l}{\partial r_{1}\:/\ \partial t}\\ {\partial r_{2}\ /\ \partial t}\\ {\partial r_{3}\ /\ \partial t}\\ {..........}\\ {\partial r_{3N}\ /\ \partial t}\end{array}\right)},\: \mathbf{A}={\left[\begin{array}{l l}{\partial r_{1}/\partial q_{1},} \: {\partial r_{1}/\partial q_{2},\ldots,\ldots,\partial r_{1}/\partial q_{M}}\\ {\partial r_{2}/\partial q_{1},} \: {\partial r_{2}/\partial q_{3},\ldots\ldots,\partial r_{2}/\partial q_{M}}\\ {\partial r_{3}/\partial q_{1},} \: {\partial r_{3}/\partial q_{2},\ldots\ldots,\partial r_{3}/\partial q_{M}}\\{\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots\ldots}\\ {\partial r_{3N}/\partial q_{1},\partial r_{3N}/\partial q_{2},\ldots\ldots\partial r_{3N}/\partial q_{M}}\end{array}\right]}$$

#### 达朗伯原理
**虚位移**跟时间相互独立，$\delta r_{\alpha}=d r_{\alpha}=\left(\partial r_{\alpha}/\partial q_{i}\right)\delta q_{i}$

**虚功** $\delta W=F_{\alpha}\delta r_{\alpha}=F_{\alpha}(\partial r_{\alpha}/\partial q_{_{i}})\delta q_{i}$

**广义力** $Q=_{\alpha}(\partial r_{\alpha}/\partial q_{_{i}})$

**广义动量** $p_{i}=\partial T\:/\:\partial\dot{q}_{i}=\partial L\:/\:\partial\dot{q}_{i}$

当一个有约束的力学系统处于力学平衡时，考虑某个时刻 t 系统坐标的一个微小的、与运动方程和约束条件都兼容的虚位移，由于每个质点都处于力学平衡即$\mathbf{F}_i=0$，可知
$$\sum_i\mathbf F_i\cdot\delta\mathbf x_i=0\:.$$
$$\mathbf{F}_{i}=\mathbf{F}_{i}^{(a)}+\mathbf{F}_{i}^{(c)}$$
$\mathbf{F}_{i}^{(a)}$为主动力，$\mathbf{F}_{i}^{(c)}$为约束力，许多完整约束的约束力的虚功之和为零，可得到**虚功原理**所有主动力的虚功之和为0
$$\sum_i\mathbf{F}_i^{(a)}\cdot\delta\mathbf{x}_i=0$$
当力学系统不平衡时，可以将$\mathbf{F}_{i}=0$替换成牛顿方程$\mathbf{F}_{i}-\dot{\mathbf{p}}_{i}=0$可得到**达朗伯原理**(d’Alembert’s principle)：
$$\sum_i(\mathbf{F}_i^{(a)}-\dot{\mathbf{p}}_i)\cdot\delta\mathbf{x}_i=0$$
$$\mathbf F_i^{(a)}\cdot\delta\mathbf x_i=\mathbf F_i^{(a)}\cdot\dfrac{\partial\mathbf x_i}{\partial q_i}\delta q_j=Q_j\delta q_j$$
由全导数易知$\dfrac{\partial\mathbf{\dot x}_i}{\partial\dot{q}_j}=\dfrac{\partial\mathbf{x}_i}{\partial q_j}$
$$\dot{\mathbf{p}}_i\cdot\delta\mathbf{x}_i=m_i\ddot{\mathbf{x}}_i\cdot\dfrac{\partial\mathbf{x}_i}{\partial q_j}\delta q_j = [\dfrac{d}{dt}\left(m_i\dot{\mathbf{x}}_i\cdot\dfrac{\partial{\mathbf{x}}_i}{\partial q_j}\right)-m_i\dot{\mathbf{x}}_i\cdot\dfrac{d}{dt}\left(\dfrac{\partial{\mathbf{x}}_i}{\partial q_j}\right)]\delta q_j$$
$$\left[\dfrac{d}{dt}\dfrac{\partial T}{\partial\dot{q}_j}-\dfrac{\partial T}{\partial q_j}-Q_j\right]\delta q_j=0$$

对于完整约束，$q_{j}$都是独立的变量因此可得一种形式的**欧拉-拉格朗日方程**
$$\dfrac{d}{dt}\dfrac{\partial T}{\partial\dot{q}_j}-\dfrac{\partial T}{\partial q_j}=Q_j$$

如果主动力是由不依赖于速度的势能$\boldsymbol{V}$给出
$$Q_j=-\dfrac{\partial V}{\partial q_j}$$
定义拉格朗日量为系统的动能与势能之差$\boldsymbol{L}=T-V$欧拉－拉格朗日方程也可以写为
$$\dfrac{d}{dt}\dfrac{\partial L}{\partial\dot{q}_j}-\dfrac{\partial L}{\partial q_j}=0$$

#### 哈密顿原理
**哈密顿作用量** 为对拉格朗日函数对时间积分，为洛伦兹标量；原理可叙述为完整、保守系统在具有相同时间间隔，从起始到终了位置的一切可能运动和真实运动相比较，真实运动的哈密顿作用量为**极值**
$$S=\int_{t_1}^{t_2}L(q,\dot{q},t)dt$$
$$\delta S=\delta\int_{t_1}^{t_2}L\ (q,\dot{q},t)\mathrm{d}t=0$$

可通过变分法推导出拉格朗日方程

$$\delta S=\int_{t_1}^{t_2}L(q_c+\delta q,\dot{q_c}+\delta\dot{q},t)dt-\int_{t_1}^{t_2}L(q_c,\dot{q_c},t)dt=\int_{t_1}^{t_2}dt\left(\dfrac{\partial L}{\partial\dot{q}_i}\delta\dot{q}_i+\dfrac{\partial L}{\partial q_i}\delta q_i\right)=0$$
$$\dfrac{\partial L}{\partial\dot{q}_i}\delta\dot{q}_i=\dfrac{d}{dt}\left(\dfrac{\partial L}{\partial\dot{q}_i}\delta q_i\right)-\left[\dfrac{d}{dt}\left(\dfrac{\partial L}{\partial\dot{q}_i}\right)\right]\delta q_i$$
$$\delta S=\left.\dfrac{\partial L}{\partial\dot{q}_i}\delta q_i\right|_{t_1}^{t_2}+\int_{t_1}^{t_2}dt\left(\dfrac{\partial L}{\partial q_i}-\dfrac{d}{dt}\dfrac{\partial L}{\partial\dot{q}_i}\right)\delta q_i=0$$
由于变分$\delta q$为无穷小量且为时间的任意函数，所以 $\delta q(t_{1})=\delta q(t_{2})=0$，第一项为 0，第二项系数也必为 0，得真实运动满足的欧拉-拉格朗日方程 (f个自由度的完整约束系统)
$$\:\dfrac{\partial L}{\partial q_i}-\dfrac{d}{dt}\dfrac{\partial L}{\partial\dot{q_i}}=0\:,\quad i=1,2,\cdots,f\:.$$


#### 哈密顿正则方程

**广义动量**  $p_i=\dfrac{\partial L}{\partial\dot{q}_i}$

**广义力** $\dfrac{dp_i}{dt}=\dfrac{\partial L}{\partial q_i}$

**哈密顿量** 是拉格朗日函数的**勒让德变换**，以广义坐标和共轭的广义动量为变量的函数，在数值上等于系统的能量 
$$H(p,q,t)=p_i\dot{q}_i-L$$
$$dH=\dot{q}_i dp_i-\dot{p}_i dq_i-\dfrac{\partial L}{\partial t}dt$$
由哈密顿量的微分可知
$$\dot{q}_i=\dfrac{\partial H}{\partial p_i}\:,\:\:\:\:\dot{p}_i=-\dfrac{\partial H}{\partial q_i}$$
若系统的哈密顿量不显含时间，则同样可得
$$\dfrac{dH}{dt}=\dfrac{\partial H}{\partial t}=-\dfrac{\partial L}{\partial t}$$
这一组方程为**哈密顿正则方程**

#### 哈密顿-雅可比方程
$$L=\dfrac{dS}{dt}=\dfrac{\partial S}{\partial t}+\dfrac{\partial S}{\partial q_i}\dot{q_i}=\dfrac{\partial S}{\partial t}+p_i\dot{q_i}$$
$$\dfrac{\partial S}{\partial t}+p_i\dot{q_i}-L=0 $$
根据哈密顿量的定义可得
$$\dfrac{\partial S}{\partial t}+H=0$$
